<div class="NewsletterSignin" style="background-size: cover; position: relative;">
  <div class="NewsletterBackground show-801">
    <img style="width: 100%;" src="{{ section.settings.background_xs | img_url: 'master' }}" />
  </div>
  <div class="NewsletterBackground show-801-1301">
    <img style="width: 100%;" src="{{ section.settings.background_s | img_url: 'master' }}" />
  </div>
  <div class="NewsletterBackground show-1301-1701">
    <img style="width: 100%;" src="{{ section.settings.background_m | img_url: 'master' }}" />
  </div>
  <div class="NewsletterBackground show-1701-">
    <img style="width: 100%;" src="{{ section.settings.background_l | img_url: 'master' }}" />
  </div>
  
  <div class="NewsletterForm" style="position: absolute;">
    <!--div style="max-width: 450px; margin: auto;">
      <img src="{{ section.settings.icon | img_url: 'master' }}" />
    </div-->
    <div class="NewsletterEmail">
      <div style="font-family: Futura; margin: auto; padding-left: 5px; margin-bottom: 10px; text-align: center;">
        <!--span style="font-size: 20px;">Sign up now to unlock EARLY-ACCESS to our</span> 
        <br />
        <span style="font-size: 24px;">CUSTOMER APPRECIATION DAY SALE!</span>
        <br />
        <span style="font-size: 14px;">Just one step from your secret deal!</span>
        </div>
        <div style="font-size: 16px; font-family: Futura; margin: auto; padding-left: 5px; display: none;">Input your email:</div-->
        <div class="{{ section.settings.klaviyo_id }}">
        </div>
        <!--div style="margin-bottom: 30px;"></div-->
      </div>
    </div>
  </div>
</div>


<style>
  {% assign selectors = section.settings.class-to-hide | split: ',' %}
  {% for selector in selectors %}
    .{{ selector | strip }} { display: none; }
  {% endfor %}
  @media screen and (min-width: 801px) {
    .show-801 { display: none; }
  }
  @media screen and (max-width: 801px), (min-width: 1301px) {
    .show-801-1301 { display: none; }
  }
  @media screen and (max-width: 1301px), (min-width: 1701px) {
    .show-1301-1701 { display: none; }
  }
  @media screen and (max-width: 1701px) {
    .show-1701- { display: none; }
  }
  @media screen and (min-width: 1301px) {
    .show-1301 { display: none; }
  }
  @media screen and (max-width: 1301px) {
    .show-1301- { display: none; }
  }
</style>
<style>
  {% if section.settings.class-to-hide != blank %}
  .NewsletterSignin { display: none; }
  {% endif %}

  @media screen and (max-width: 801px) {
    .NewsletterForm {
      padding: 15px 2%; width: 90%; left: 0; right: 0; margin: auto; max-width: 580px;
      {% if section.settings.form_bottom_xs == blank %} top: 50%; transform: translateY(-50%); {% else %}{{ section.settings.form_bottom_xs }}{% endif %}
    }
    .NewsletterTitle {
      font-size: 18px;
    }
    .Disclaimer {
      font-size: 8px;
    }
    .NewsletterSms, .NewsletterEmail {
      /*top: 50%; transform: translateY(-50%); position: absolute;*/ left: 0; width: 100%; max-width: 450px; margin: auto;
    }
  }
  @media screen and (min-width: 801px) and (max-width: 1301px) {
    .NewsletterForm {
      padding: 20px 2%; width: 90%; left: 0; right: 0; margin: auto; max-width: 580px;
      {% if section.settings.form_bottom_s == blank %} top: 50%; transform: translateY(-50%); min-height: 30%; {% else %}{{ section.settings.form_bottom_s }}{% endif %}
    }
    .NewsletterTitle {
      font-size: 24px; line-height: 1.3; padding: 0 10px;
    }
    .Disclaimer {
      font-size: 10px;
    }
    .NewsletterSms, .NewsletterEmail {
       left: 0; width: 100%; max-width: 410px; margin: auto;
    }
  }
  @media screen and (min-width: 1301px) and (max-width: 1701px) {
    .NewsletterForm {
      padding: 20px 2%; width: 90%; margin: auto; max-width: 580px;
      {% if section.settings.form_bottom_s == blank %} top: 50%; transform: translateY(-50%); min-height: 30%; {% else %}{{ section.settings.form_bottom_s }}{% endif %}
      {% if section.settings.align_left %} left: 5%; {% else %} right: 5%; {% endif %}
    }
    .NewsletterTitle {
      font-size: 24px; line-height: 1.3; padding: 0 10px;
    }
    .Disclaimer {
      font-size: 10px;
    }
    .NewsletterSms, .NewsletterEmail {
      left: 0; width: 100%; max-width: 410px; margin: auto;
    }
  }
  @media screen and (min-width: 1701px) {
    .NewsletterForm {
      padding: 20px 3%; width: 40%; min-width: 30%; max-width: 580px; 
      top: 50%; transform: translateY(-50%); min-height: 30%;
      {% if section.settings.align_left %} left: 5%; {% else %} right: 5%; {% endif %}
    }
    .NewsletterTitle {
      font-size: 24px; padding: 0 10px;
    }
    .Disclaimer {
      font-size: 12px;
    }
    .NewsletterSms, .NewsletterEmail {
      max-width: 410px; margin: auto;
    }
  }
</style>

<script type="text/javascript" src="//static.klaviyo.com/onsite/js/klaviyo.js?company_id=U2RDur"></script>
{% if section.settings.class-to-hide != blank %}
<script>
  var timer;
  function showSignin()
  {
    document.querySelector(".NewsletterSignin").style.display = "block";
  }
  function hideSignin()
  {
    clearTimeout(timer);
    document.querySelector(".NewsletterSignin").style.display = "none";
    {% assign selectors = section.settings.class-to-hide | split: ',' %}
    {% for selector in selectors %}
      if (document.querySelector("{{ selector | strip }}"))
        document.querySelector("{{ selector | strip }}").style.display = "block";
    {% endfor %}
  }
  function SetCookie(name, value, days)
  {
    var date = new Date();
    var time = date.getTime() + (days*24*60*60*1000);
    date.setTime(time);
    var expires = "expires=" + date.toGMTString();
    if (time)
      document.cookie = name + "=" + value + ";" + expires + ";path=/";
  }
  function GetCookie(name)
  {
    var cookies = decodeURIComponent(document.cookie).split(';');
    for(var i = 0; i < cookies.length; i ++)
    {
      var ck = cookies[i].trim();
      if (ck.indexOf(name + "=") == 0)
        return ck.substring(name.length + 1, ck.length);
    }
    return "";
  }
  window.addEventListener("klaviyoForms", function(e) { 
    if (e.detail.type == 'submit')
    {
      if (GetCookie("klaviyo_signin") == "")
        SetCookie("klaviyo_signin", e.detail.metaData.$email, 730);
      timer = setInterval(hideSignin, 1500, this);
    }
  });
  var _learnq = _learnq || [];
  window.addEventListener("load", function() {
    if (_learnq.isIdentified() == true)
      hideSignin();
    else
      showSignin();
  });
</script>
{% endif %}

{% schema %}
  {
    "name": "Signin to show",
    "settings": [
      {
          "type": "text",
          "id": "class-to-hide",
          "label": "Input the target css selector name to hide"
      },
      {
          "type": "image_picker",
          "id": "background_xs",
          "label": "Background for mobile screen"
      },
      {
          "type": "image_picker",
          "id": "background_s",
          "label": "Background for small screen"
      },
      {
          "type": "image_picker",
          "id": "background_m",
          "label": "Background for middle screen"
      },
      {
          "type": "image_picker",
          "id": "background_l",
          "label": "Background for large screen"
      },
      {
          "type": "html",
          "id": "subtitle",
          "label": "Subtitle"
      },
      {
          "type": "html",
          "id": "disclaimer",
          "label": "Disclaimer"
      },
      {
          "type": "text",
          "id": "klaviyo_id",
          "label": "Klaviyo ID"
      },
      {
          "type": "text",
          "id": "form_bottom_xs",
          "label": "Form bottom position, mobile screen"
      },
      {
          "type": "text",
          "id": "form_bottom_s",
          "label": "Form bottom position, small screen"
      },
      {
          "type": "checkbox",
          "id": "align_left",
          "label": "Align left in desktop screens",
          "default": false
      }
    ],
    "presets": [{
      "name": "Signin to show"
    }]
  }
{% endschema %}